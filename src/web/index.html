<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PER VISOR 2.0 - Nueva Arquitectura</title>
    <script>
        // Redirecci√≥n autom√°tica a la nueva arquitectura
        window.location.href = 'visor-nueva-arquitectura.html';
    </script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="favicon.svg">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=20250910i">
    
    <!-- OpenAI moderna librer√≠a -->
    <script type="module">
        // Intentar importar OpenAI moderna si est√° disponible
        try {
            const { OpenAI } = await import('https://cdn.skypack.dev/openai');
            window.OpenAI = OpenAI;
            console.log('‚úÖ OpenAI moderna cargada desde CDN');
        } catch (error) {
            console.log('‚ö†Ô∏è OpenAI moderna no disponible desde CDN:', error);
        }
    </script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container-fluid">
            <div class="header-content">
                <div class="header-icon">üö¢</div>
                <div class="header-text">
                    <h1 class="header-title">Visor de Ex√°menes N√°uticos</h1>
                    <p class="header-subtitle">Explora y estudia las preguntas de los ex√°menes oficiales de t√≠tulos n√°uticos</p>
                </div>
                <div class="header-actions">
                    <a href="visor-nueva-arquitectura.html" class="btn btn-success me-2" title="Nueva Arquitectura 2.0">
                        üöÄ NUEVA ARQUITECTURA
                    </a>
                    <button id="debugToggle" class="debug-toggle-btn" title="Configuraci√≥n y debug">
                        ‚öôÔ∏è
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container-fluid main-container">
        <!-- Filtros -->
        <div class="filters-section">
            <div class="row align-items-end">
                <div class="col-md-2">
                    <div class="filter-group">
                        <label for="filterConvocatoria">üìÖ CONVOCATORIA</label>
                        <select class="form-select" id="filterConvocatoria">
                            <option value="all">Todas las convocatorias</option>
                            <!-- Opciones cargadas din√°micamente desde JSON -->
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="filter-group">
                        <label for="filterTitulacion">üéì TITULACI√ìN</label>
                        <select class="form-select" id="filterTitulacion">
                            <option value="all">Todas las titulaciones</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="filter-group">
                        <label for="filterTest">üìù TEST</label>
                        <select class="form-select" id="filterTest">
                            <option value="all">Todos los tests</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="filter-group">
                        <label for="filterTema">üéØ TEMA</label>
                        <select class="form-select" id="filterTema">
                            <option value="all">Todos los temas</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="filter-group">
                        <label>&nbsp;</label>
                        <div class="form-check" style="padding-top: 8px;">
                            <input class="form-check-input" type="checkbox" id="filterDuplicados" checked>
                            <label class="form-check-label" for="filterDuplicados">
                                üîÑ Con duplicados
                            </label>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="filter-group">
                        <label for="searchInput">üîç BUSCAR POR ID</label>
                        <div class="search-input-group">
                            <input type="text" class="form-control" id="searchInput" 
                                   placeholder="Ej: per_examen_001_001">
                            <button class="search-clear" id="clearSearch">√ó</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mt-3">
                <div class="col-12">
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="searchBtn">üîç BUSCAR</button>
                        <button class="btn btn-secondary" id="clearFilters">LIMPIAR</button>
                        <button class="btn btn-success" id="toggleAnswers">üôà OCULTAR RESPUESTAS</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Estad√≠sticas -->
        <div class="stats-section">
            <div class="stats-card">
                <div class="stat-item">
                    <div class="stat-value" id="totalQuestions">135</div>
                    <div class="stat-label">PREGUNTAS</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="questionsWithAnswers">135</div>
                    <div class="stat-label">CON RESPUESTA</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="coveragePercentage">100%</div>
                    <div class="stat-label">COBERTURA</div>
                </div>
            </div>
        </div>

        <!-- Preguntas -->
        <div class="questions-container" id="questionsContainer">
            <!-- Las preguntas se cargar√°n aqu√≠ din√°micamente -->
        </div>

        <!-- Paginaci√≥n -->
        <div class="pagination-section">
            <nav aria-label="Paginaci√≥n de preguntas">
                <ul class="pagination justify-content-center" id="pagination">
                    <!-- La paginaci√≥n se generar√° din√°micamente -->
                </ul>
            </nav>
        </div>
    </div>

    <!-- Modal de edici√≥n -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Editar Pregunta</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <div class="mb-3">
                            <label for="editTema" class="form-label">Tema</label>
                            <select class="form-select" id="editTema">
                                <option value="">Sin tema</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editRespuesta" class="form-label">Respuesta Correcta</label>
                            <select class="form-select" id="editRespuesta">
                                <option value="">Sin respuesta</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveChanges">Guardar cambios</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading spinner -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js?v=20250913d"></script>
</body>
</html>